{"version":3,"file":"EventList-DGXRoI3Z.js","sources":["../../src/components/EventCard.vue","../../src/components/EventList.vue"],"sourcesContent":["<template>\n  <div class=\"card event-card\" @click=\"handleCardClick\">\n    <!-- <img :src=\"event.imageUrl ? event.imageUrl : '/images/default-event.jpg'\" alt=\"event.title\" /> -->\n    <h3 :class=\"['event-title', `category-${event.category}`]\">{{ event.title }}</h3>\n    <p class=\"event-time\">\n      {{ formatDate(event.startime) }}--{{ formatDate(event.endtime) }}\n    </p>\n    <p>Location: {{ event.location }}</p>\n    <p class=\"description\">{{ event.description }}</p>\n        <p v-if=\"event.link\" class=\"event-link\">\n      <a :href=\"event.link\" target=\"_blank\" rel=\"noopener noreferrer\">{{ event.link }}</a>\n    </p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useEventDialogStore } from '../stores/eventDialog';\nimport type { Event } from '../types/event';\nimport '../assets/eventcard.css';\n\nconst props = defineProps<{\n  event: Event;\n}>();\n\nconst eventDialogStore = useEventDialogStore();\n\n// 只显示年月日和小时分钟\nconst formatDate = (ts: any) => {\n    if (!ts) return '';\n    const date = typeof ts.toDate === 'function' ? ts.toDate() : new Date(ts);\n    // 获取小时、分钟和 AM/PM\n    let [time, ampm] = date.toLocaleTimeString(undefined, {\n        hour: '2-digit',\n        minute: '2-digit',\n        hour12: true,\n    }).split(' ');\n    ampm = ampm?.toLowerCase() || '';\n    // 获取月和日\n    const day = date.toLocaleDateString(undefined, {\n        month: '2-digit',\n        day: '2-digit',\n    });\n    return `${time}${ampm} ${day}`;\n};\n\nconst handleCardClick = () => {\n  eventDialogStore.openDialog(props.event);\n};\n</script>\n","<template>\n  <div class=\"event-list\">\n    <div v-if=\"filteredEvents.length === 0\" class=\"loading\">No events found. You may need VPN.</div>\n    <div v-else class=\"events-grid\">\n      <EventCard\n        v-for=\"event in filteredEvents\"\n        :key=\"event.id\"\n        :event=\"event\"\n        @open-card=\"$emit('open-card', event)\"\n      />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted } from 'vue';\nimport { useEventStore } from '../stores/event';\nimport EventCard from './EventCard.vue';\nimport { useRoute } from 'vue-router';\n\nconst props = defineProps<{ category?: string }>();\nconst eventStore = useEventStore();\nconst route = useRoute();\n\nconst filteredEvents = computed(() => {\n  let events = !props.category\n    ? eventStore.events\n    : eventStore.events.filter(e => e.category === props.category);\n\n  // 搜索过滤\n  const q = (route.query.q as string || '').toLowerCase();\n  if (q) {\n    events = events.filter(e =>\n      e.title.toLowerCase().includes(q) ||\n      e.description.toLowerCase().includes(q) ||\n      (e.location && e.location.toLowerCase().includes(q)) ||\n      (e.tags && e.tags.join(',').toLowerCase().includes(q)) ||\n      (e.organizerName && e.organizerName.toLowerCase().includes(q))\n    );\n    //考虑更精细的筛选，比如按时间，比如tags selection，比如直接输入09/25搜索09月25日的活动\n  }\n\n  // 只显示未过期活动\n  const now = new Date();\n  events = events.filter(e => {\n    const end = typeof e.endtime?.toDate === 'function'\n      ? e.endtime.toDate()\n      : new Date(e.endtime);\n    return end > now;\n  });\n\n  // 按开始时间倒序\n  return events.slice().sort((a, b) => {\n    const aTime = typeof a.startime?.toDate === 'function' ? a.startime.toDate() : new Date(a.startime);\n    const bTime = typeof b.startime?.toDate === 'function' ? b.startime.toDate() : new Date(b.startime);\n    return aTime.getTime() - bTime.getTime();\n  });\n});\n\nonMounted(() => {\n    if (eventStore.events.length === 0) {\n        eventStore.fetchEvents();\n    }\n});\n</script>\n\n<style scoped>\n.event-list {\n    padding: 1rem;\n}\n\n.loading,\n.no-events {\n    text-align: center;\n    padding: 2rem;\n    color: #666;\n    font-size: 1.1rem;\n}\n\n.events-grid {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr); /* 固定3列 */\n    gap: 2.1rem 1.5rem;\n    width: 100%;\n    box-sizing: border-box;\n    padding: 1rem 0;\n}\n\n@media (max-width: 900px) {\n    .events-grid {\n        grid-template-columns: repeat(2, 1fr);\n    }\n}\n@media (max-width: 576px) {\n    .event-list {\n        padding: 0.2rem; /* 左右边距几乎为0 */\n    }\n    .events-grid {\n        grid-template-columns: repeat(2, 1fr);\n        gap: 1rem 0.5rem;\n        width: 100%;\n        box-sizing: border-box;\n        padding: 0.2rem 0;\n    }\n}\n</style>"],"names":["props","__props","eventDialogStore","useEventDialogStore","formatDate","ts","date","time","ampm","day","handleCardClick","eventStore","useEventStore","route","useRoute","filteredEvents","computed","events","q","now","_a","a","b","aTime","bTime","_b","onMounted"],"mappings":"2TAoBA,MAAMA,EAAQC,EAIRC,EAAmBC,EAAoB,EAGvCC,EAAcC,GAAY,CACxB,GAAA,CAACA,EAAW,MAAA,GACV,MAAAC,EAAO,OAAOD,EAAG,QAAW,WAAaA,EAAG,OAAO,EAAI,IAAI,KAAKA,CAAE,EAExE,GAAI,CAACE,EAAMC,CAAI,EAAIF,EAAK,mBAAmB,OAAW,CAClD,KAAM,UACN,OAAQ,UACR,OAAQ,EAAA,CACX,EAAE,MAAM,GAAG,EACLE,GAAAA,GAAA,YAAAA,EAAM,gBAAiB,GAExB,MAAAC,EAAMH,EAAK,mBAAmB,OAAW,CAC3C,MAAO,UACP,IAAK,SAAA,CACR,EACD,MAAO,GAAGC,CAAI,GAAGC,CAAI,IAAIC,CAAG,EAChC,EAEMC,EAAkB,IAAM,CACXR,EAAA,WAAWF,EAAM,KAAK,CACzC,8iBC3BA,MAAMA,EAAQC,EACRU,EAAaC,EAAc,EAC3BC,EAAQC,EAAS,EAEjBC,EAAiBC,EAAS,IAAM,CACpC,IAAIC,EAAUjB,EAAM,SAEhBW,EAAW,OAAO,OAAO,GAAK,EAAE,WAAaX,EAAM,QAAQ,EAD3DW,EAAW,OAIf,MAAMO,GAAKL,EAAM,MAAM,GAAe,IAAI,YAAY,EAClDK,IACFD,EAASA,EAAO,UACd,EAAE,MAAM,YAAc,EAAA,SAASC,CAAC,GAChC,EAAE,YAAY,cAAc,SAASA,CAAC,GACrC,EAAE,UAAY,EAAE,SAAS,YAAY,EAAE,SAASA,CAAC,GACjD,EAAE,MAAQ,EAAE,KAAK,KAAK,GAAG,EAAE,YAAY,EAAE,SAASA,CAAC,GACnD,EAAE,eAAiB,EAAE,cAAc,cAAc,SAASA,CAAC,CAC9D,GAKI,MAAAC,MAAU,KACP,OAAAF,EAAAA,EAAO,OAAY,GAAA,OAI1B,OAHY,QAAOG,EAAA,EAAE,UAAF,YAAAA,EAAW,SAAW,WACrC,EAAE,QAAQ,OAAO,EACjB,IAAI,KAAK,EAAE,OAAO,GACTD,CAAA,CACd,EAGMF,EAAO,MAAM,EAAE,KAAK,CAACI,EAAGC,IAAM,SACnC,MAAMC,EAAQ,QAAOH,EAAAC,EAAE,WAAF,YAAAD,EAAY,SAAW,WAAaC,EAAE,SAAS,OAAO,EAAI,IAAI,KAAKA,EAAE,QAAQ,EAC5FG,EAAQ,QAAOC,EAAAH,EAAE,WAAF,YAAAG,EAAY,SAAW,WAAaH,EAAE,SAAS,OAAO,EAAI,IAAI,KAAKA,EAAE,QAAQ,EAClG,OAAOC,EAAM,UAAYC,EAAM,QAAQ,CAAA,CACxC,CAAA,CACF,EAED,OAAAE,EAAU,IAAM,CACRf,EAAW,OAAO,SAAW,GAC7BA,EAAW,YAAY,CAC3B,CACH"}