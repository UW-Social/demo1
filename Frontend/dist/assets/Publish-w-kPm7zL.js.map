{"version":3,"file":"Publish-w-kPm7zL.js","sources":["../../src/components/EventForm.vue","../../src/views/Publish.vue"],"sourcesContent":["<template>\r\n  <div class=\"event-form\">\r\n    <h2>Publish New Event</h2>\r\n    <form @submit.prevent=\"handleSubmit\">\r\n      <div class=\"form-group\">\r\n        <label for=\"title\">Event Title</label>\r\n        <input\r\n          id=\"title\"\r\n          v-model=\"formData.title\"\r\n          type=\"text\"\r\n          required\r\n          placeholder=\"Enter event title\"\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"description\">Description</label>\r\n        <textarea\r\n          id=\"description\"\r\n          v-model=\"formData.description\"\r\n          type=\"text\"\r\n          required\r\n          :placeholder=\"descriptionPlaceholder\"\r\n          rows=\"3\"\r\n        ></textarea>\r\n      </div>\r\n\r\n      <div class=\"form-row\">\r\n        <div class=\"form-group\">\r\n          <label for=\"startDate\">Start Date</label>\r\n          <input\r\n            id=\"startDate\"\r\n            v-model=\"formData.startDate\"\r\n            type=\"date\"\r\n            required\r\n          >\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"startTime\">Start Time</label>\r\n          <input\r\n            id=\"startTime\"\r\n            v-model=\"formData.startTime\"\r\n            type=\"time\"\r\n            required\r\n          >\r\n        </div>\r\n      </div>\r\n      <div class=\"form-row\">\r\n        <div class=\"form-group\">\r\n          <label for=\"endDate\">End Date</label>\r\n          <input\r\n            id=\"endDate\"\r\n            v-model=\"formData.endDate\"\r\n            type=\"date\"\r\n            required\r\n          >\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"endTime\">End Time</label>\r\n          <input\r\n            id=\"endTime\"\r\n            v-model=\"formData.endTime\"\r\n            type=\"time\"\r\n            required\r\n          >\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"location\">Location</label>\r\n        <input\r\n          id=\"location\"\r\n          v-model=\"formData.location\"\r\n          type=\"text\"\r\n          required\r\n          placeholder=\"Event location\"\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"category\">Category</label>\r\n        <select id=\"category\" v-model=\"formData.category\" required>\r\n          <option value=\"\">Select category</option>\r\n          <option value=\"academic\">Academic</option>\r\n          <option value=\"club\">Club</option>\r\n          <option value=\"sports\">Sports</option>\r\n          <option value=\"games\">Games</option>\r\n          <option value=\"culture\">Culture</option>\r\n          <option value=\"interest\">Interest</option>\r\n          <option value=\"HFS\">HFS</option>\r\n          <!-- <option value=\"other\">Other</option> -->\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"maxParticipants\">Max Participants (Optional)</label>\r\n        <input\r\n          id=\"maxParticipants\"\r\n          v-model=\"formData.maxParticipants\"\r\n          type=\"number\"\r\n          min=\"1\"\r\n          placeholder=\"No limit if not set\"\r\n        >\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"tags\">Tags (comma separated)</label>\r\n        <input\r\n          id=\"tags\"\r\n          v-model=\"tagsInput\"\r\n          type=\"text\"\r\n          placeholder=\"e.g., study, social, sports\"\r\n        >\r\n      </div>\r\n\r\n      <!-- <div class=\"form-group\">\r\n        <label for=\"image\">Event Image (Optional)</label>\r\n        <input\r\n          id=\"image\"\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          @change=\"handleImageUpload\"\r\n        > -->\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"link\">Event Link (Optional)</label>\r\n        <input\r\n          id=\"link\"\r\n          v-model=\"formData.link\"\r\n          type=\"url\"\r\n          placeholder=\"e.g., https://meeting.com/your-event\"\r\n        >\r\n      </div>\r\n\r\n      <button type=\"submit\" class=\"submit-btn\" :disabled=\"isSubmitting\">\r\n        {{ isSubmitting ? 'Publishing...' : 'Publish!' }}\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { useUserStore } from '../stores/user';\r\nimport { useEventStore } from '../stores/event';\r\nimport { collection, addDoc,Timestamp } from 'firebase/firestore';\r\nimport { db } from '../firebase/config';\r\nimport type { Event } from '../types/event';\r\n\r\nconst router = useRouter();\r\nconst userStore = useUserStore();\r\nconst eventStore = useEventStore();\r\nconst isSubmitting = ref(false);\r\n\r\nconst formData = ref({\r\n  title: '',\r\n  description: '',\r\n  startDate: '',\r\n  startTime: '',\r\n  endDate: '',\r\n  endTime: '',\r\n  location: '',\r\n  category: '',\r\n  maxParticipants: null as number | null,\r\n  tags: [] as string[],\r\n  link: '',\r\n});\r\n\r\nconst tagsInput = computed({\r\n  get: () => formData.value.tags.join(', '),\r\n  set: (value) => {\r\n    formData.value.tags = value.split(',').map(tag => tag.trim()).filter(Boolean);\r\n  }\r\n});\r\n\r\n// 新增：动态 placeholder\r\nconst descriptionPlaceholder = computed(() =>\r\n  formData.value.title\r\n    ? `Come and enjoy ${formData.value.title}!`\r\n    : 'Describe your event here...'\r\n);\r\n\r\nconst handleSubmit = async () => {\r\n  if (!userStore.userProfile) {\r\n    alert('Please log in to publish an event!');\r\n    return;\r\n  }\r\n\r\n  isSubmitting.value = true;\r\n  try {\r\n    const start = new Date(`${formData.value.startDate}T${formData.value.startTime}`);\r\n    const end = new Date(`${formData.value.endDate}T${formData.value.endTime}`);\r\n    if (start >= end) {\r\n      alert('End time must be after start time.');\r\n      return;\r\n    }\r\n    // Prepare eventData with maxParticipants as number or undefined\r\n    const {\r\n      maxParticipants,\r\n      ...restFormData\r\n    } = formData.value;\r\n\r\n    const eventData: Omit<Event, 'id'> = {\r\n      title: formData.value.title,\r\n      description: formData.value.description,\r\n      location: formData.value.location,\r\n      category: formData.value.category,\r\n      tags: formData.value.tags,\r\n      startime: Timestamp.fromDate(start),\r\n      endtime: Timestamp.fromDate(end),\r\n      maxParticipants: formData.value.maxParticipants,\r\n      organizerId: userStore.userProfile.uid,\r\n      organizerName: userStore.userProfile.displayName || 'Anonymous',\r\n      organizerAvatar: userStore.userProfile.photoURL || '',\r\n      createdAt: new Date().toISOString(),\r\n      participants: [],\r\n      link: formData.value.link,\r\n    };\r\n\r\n    await addDoc(collection(db, 'events'), eventData);\r\n    alert('Successfully published!');\r\n\r\n    // 更新全局事件列表\r\n    await eventStore.fetchEvents();\r\n\r\n    router.push('/events');\r\n  } catch (error) {\r\n    console.error('Failed to publish event:', error);\r\n    alert('Failed to publish event.');\r\n  } finally {\r\n    isSubmitting.value = false;\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.event-form {\r\n  max-width: 800px;\r\n  margin: 2rem auto;\r\n  padding: 2rem;\r\n  background: white;\r\n  border-radius: 15px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nh2 {\r\n  color: #333;\r\n  margin-bottom: 2rem;\r\n  text-align: center;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 0.5rem;\r\n  color: #666;\r\n  font-weight: 500;\r\n}\r\n#description::placeholder {\r\n  font-weight: 500;\r\n}\r\n#title,\r\n#description,\r\n#location {\r\n  /* font-weight: 600; */\r\n  border-width: 2px;\r\n}\r\n\r\n</style>","<template>\r\n  <div class=\"publish-page\">\r\n    <EventForm />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport EventForm from '../components/EventForm.vue';\r\n</script>\r\n\r\n<style scoped>\r\n.publish-page {\r\n  padding: 1rem;\r\n  margin-top: 35px;\r\n  min-height: calc(100vh - 100px);\r\n  background: #f5f5f5;\r\n}\r\n</style> "],"names":["router","useRouter","userStore","useUserStore","eventStore","useEventStore","isSubmitting","ref","formData","tagsInput","computed","value","tag","descriptionPlaceholder","handleSubmit","start","end","maxParticipants","restFormData","eventData","Timestamp","addDoc","collection","db","error","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","$event","_vModelText","_hoisted_3","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_vModelSelect","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_createVNode","EventForm"],"mappings":"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"}